---
title: Facturación en Project Service Automation
description: En este tema se proporciona información sobre la facturación.
author: rumant
manager: kfend
ms.service: business-applications
ms.custom:
- dyn365-projectservice
ms.date: 03/11/2019
ms.topic: article
ms.prod: ''
ms.technology: Microsoft Dynamics 365  Project Service Automation 2.x and 3.x
audience: Admin
search.audienceType:
- admin
- customizer
- enduser
search.app:
- D365PS
ms.openlocfilehash: 8d95f17aba0a4cab65a6f020aade5e19568de3be
ms.sourcegitcommit: 8c786230ef2a497280885b827162561776e2eb00
ms.translationtype: HT
ms.contentlocale: es-ES
ms.lasthandoff: 03/24/2020
ms.locfileid: "3755930"
---
# <a name="invoicing-in-project-service-automation"></a><span data-ttu-id="cd544-103">Facturación en Project Service Automation</span><span class="sxs-lookup"><span data-stu-id="cd544-103">Invoicing in Project Service Automation</span></span>

[!INCLUDE[cc-applies-to-psa-app-3.x](../includes/cc-applies-to-psa-app-3x.md)]

<span data-ttu-id="cd544-104">La facturación en Dynamics 365 Project Service Automation es útil porque proporciona a los jefes de proyecto un segundo nivel de aprobación antes de crear las facturas para los clientes.</span><span class="sxs-lookup"><span data-stu-id="cd544-104">Invoicing in Dynamics 365 Project Service Automation is useful because it gives project managers a second level of approval before they create invoices for customers.</span></span> <span data-ttu-id="cd544-105">El primer nivel de aprobación se completa cuando se aprueban las entradas de tiempo y gastos que envían los miembros del proyecto.</span><span class="sxs-lookup"><span data-stu-id="cd544-105">The first level of approval is completed when the time and expense entries that project team members submit are approved.</span></span>

<span data-ttu-id="cd544-106">PSA no está diseñado para generar facturas de cara al cliente por las siguientes razones:</span><span class="sxs-lookup"><span data-stu-id="cd544-106">PSA isn't designed to generate customer-facing invoices, for the following reasons:</span></span>

- <span data-ttu-id="cd544-107">No contiene información fiscal.</span><span class="sxs-lookup"><span data-stu-id="cd544-107">It doesn't contain tax information.</span></span>
- <span data-ttu-id="cd544-108">No puede convertir otras divisas a la divisa de facturación con tipos de cambio configurados correctamente.</span><span class="sxs-lookup"><span data-stu-id="cd544-108">It can't convert other currencies to the invoicing currency by using correctly configured exchange rates.</span></span>
- <span data-ttu-id="cd544-109">No puede dar el formato correcto a las facturas para que se puedan imprimir.</span><span class="sxs-lookup"><span data-stu-id="cd544-109">It can't correctly format invoices so that they can be printed.</span></span>

<span data-ttu-id="cd544-110">En su lugar, puede usar un sistema de contabilidad financiero para crear facturas de cara al cliente que utilicen la información de las propuestas de factura que se generan en PSA.</span><span class="sxs-lookup"><span data-stu-id="cd544-110">Instead, you can use a financial or accounting system to create customer-facing invoices that use the information from invoice proposals that are generated in PSA.</span></span>

## <a name="creating-project-invoices-in-psa"></a><span data-ttu-id="cd544-111">Creación de facturas de proyecto en PSA</span><span class="sxs-lookup"><span data-stu-id="cd544-111">Creating project invoices in PSA</span></span>

<span data-ttu-id="cd544-112">Las facturas de proyecto se pueden de una en una o de forma masiva.</span><span class="sxs-lookup"><span data-stu-id="cd544-112">Project invoices can be created one at a time or in bulk.</span></span> <span data-ttu-id="cd544-113">Puede crearlas manualmente, o bien se pueden configurar para que se generen de forma automática.</span><span class="sxs-lookup"><span data-stu-id="cd544-113">You can create them manually, or they can be configured so that they are generated in automated runs.</span></span>

### <a name="manually-create-project-invoices-in-psa"></a><span data-ttu-id="cd544-114">Crear facturas de proyecto manualmente en PSA</span><span class="sxs-lookup"><span data-stu-id="cd544-114">Manually create project invoices in PSA</span></span>

<span data-ttu-id="cd544-115">En la página lista **Contratos de proyecto**, podrá crear facturas de proyecto por separado para cada contrato de proyecto, o bien puede crear facturas de forma masiva para varios contratos de proyecto.</span><span class="sxs-lookup"><span data-stu-id="cd544-115">From the **Project Contracts** list page, you can create project invoices separately for each project contract, or you can create invoices in bulk for multiple project contracts.</span></span>

<span data-ttu-id="cd544-116">Siga este paso para crear una factura para un contrato de proyecto específico.</span><span class="sxs-lookup"><span data-stu-id="cd544-116">Follow this step to create an invoice for a specific project contract.</span></span>

- <span data-ttu-id="cd544-117">En la página de lista **Contratos de proyecto**, abra un contrato de proyecto y después seleccione **Crear factura**.</span><span class="sxs-lookup"><span data-stu-id="cd544-117">On the **Project Contracts** list page, open a project contract, and then select **Create Invoice**.</span></span>

    ![Creación de facturas de proyecto para un contrato de proyecto específico](media/CreateProjectInvoicesOneByOne.png)

    <span data-ttu-id="cd544-119">El sistema genera una factura para todas las transacciones del contrato de proyecto seleccionado que tienen el estado **Listo para facturar**.</span><span class="sxs-lookup"><span data-stu-id="cd544-119">An invoice is generated for all transactions for the selected project contract that have a status of **Ready to Invoice**.</span></span> <span data-ttu-id="cd544-120">Estas transacciones incluyen datos de tiempo, gastos, hitos y líneas de contrato basadas en producto.</span><span class="sxs-lookup"><span data-stu-id="cd544-120">These transactions include time, expenses, milestones, and product-based contract lines.</span></span>

<span data-ttu-id="cd544-121">Siga estos pasos para crear facturas de forma masiva.</span><span class="sxs-lookup"><span data-stu-id="cd544-121">Follow these steps to create invoices in bulk.</span></span>

1. <span data-ttu-id="cd544-122">En la página de lista **Contratos de proyecto**, seleccione uno o varios contratos de proyecto para los que desee crear una factura y después seleccione **Crear facturas de proyecto**.</span><span class="sxs-lookup"><span data-stu-id="cd544-122">On the **Project Contracts** list page, select one or more project contracts that you must create an invoice for, and then select **Create Project Invoices**.</span></span>

    ![Creación de facturas de proyecto de forma masiva](media/CreateProjectInvoicesBulk.png)

    <span data-ttu-id="cd544-124">Un mensaje de advertencia le informará de que es posible que haya un retraso antes de que se creen las facturas.</span><span class="sxs-lookup"><span data-stu-id="cd544-124">A warning message informs you that there might be a delay before invoices are created.</span></span> <span data-ttu-id="cd544-125">También se muestra el proceso.</span><span class="sxs-lookup"><span data-stu-id="cd544-125">The process is also shown.</span></span>

2. <span data-ttu-id="cd544-126">Seleccione **Aceptar** para cerrar el cuadro del mensaje.</span><span class="sxs-lookup"><span data-stu-id="cd544-126">Select **OK** to close the message box.</span></span>

    <span data-ttu-id="cd544-127">El sistema genera una factura para todas las transacciones de una línea de contrato con el estado **Listo para facturar**.</span><span class="sxs-lookup"><span data-stu-id="cd544-127">An invoice is generated for all transactions on a contract line that have a status of **Ready to Invoice**.</span></span> <span data-ttu-id="cd544-128">Estas transacciones incluyen datos de tiempo, gastos, hitos y líneas de contrato basadas en producto.</span><span class="sxs-lookup"><span data-stu-id="cd544-128">These transactions include time, expenses, milestones, and product-based contract lines.</span></span>

3. <span data-ttu-id="cd544-129">Para ver las facturas que se generan, vaya a **Ventas** \> **Facturación** \> **Facturas**.</span><span class="sxs-lookup"><span data-stu-id="cd544-129">To view the invoices that are generated, go to **Sales** \> **Billing** \> **Invoices**.</span></span> <span data-ttu-id="cd544-130">Se mostrará una factura para cada contrato de proyecto.</span><span class="sxs-lookup"><span data-stu-id="cd544-130">You will see one invoice for each project contract.</span></span>

### <a name="set-up-automated-creation-of-project-invoices-in-psa"></a><span data-ttu-id="cd544-131">Configurar la creación automática de facturas de proyecto en PSA</span><span class="sxs-lookup"><span data-stu-id="cd544-131">Set up automated creation of project invoices in PSA</span></span>

<span data-ttu-id="cd544-132">Siga estos pasos para configurar la ejecución automática de facturas en PSA.</span><span class="sxs-lookup"><span data-stu-id="cd544-132">Follow these steps to configure an automated invoice run in PSA.</span></span>

1. <span data-ttu-id="cd544-133">Vaya a **Project Service** \> **Configuración** \> **Trabajos por lotes**.</span><span class="sxs-lookup"><span data-stu-id="cd544-133">Go to **Project Service** \> **Settings** \> **Batch jobs**.</span></span>
2. <span data-ttu-id="cd544-134">Cree un trabajo por lotes y asígnele el nombre **Creación de facturas de PSA**.</span><span class="sxs-lookup"><span data-stu-id="cd544-134">Create a batch job, and name it **PSA Create Invoices**.</span></span> <span data-ttu-id="cd544-135">El nombre del trabajo por lotes debe incluir el término "Creación de facturas".</span><span class="sxs-lookup"><span data-stu-id="cd544-135">The name of the batch job must include the term "Create Invoices."</span></span>
3. <span data-ttu-id="cd544-136">En el campo **Tipo de trabajo**, seleccione **Ninguno**.</span><span class="sxs-lookup"><span data-stu-id="cd544-136">In the **Job type** field, select **None**.</span></span> <span data-ttu-id="cd544-137">De forma predeterminada, las opciones **Frecuencia diaria** y **Está activo** están configuradas con el valor **Sí**.</span><span class="sxs-lookup"><span data-stu-id="cd544-137">By default, the **Frequency Daily** and **Is Active** options are set to **Yes**.</span></span>
4. <span data-ttu-id="cd544-138">Seleccione **Ejecutar flujo de trabajo**.</span><span class="sxs-lookup"><span data-stu-id="cd544-138">Select **Run Workflow**.</span></span> <span data-ttu-id="cd544-139">En el cuadro de diálogo **Buscar registros**, se mostrarán tres flujos de trabajo:</span><span class="sxs-lookup"><span data-stu-id="cd544-139">In the **Look Up Record** dialog box, you will see three workflows:</span></span>

    - <span data-ttu-id="cd544-140">ProcessRunCaller</span><span class="sxs-lookup"><span data-stu-id="cd544-140">ProcessRunCaller</span></span>
    - <span data-ttu-id="cd544-141">ProcessRunner</span><span class="sxs-lookup"><span data-stu-id="cd544-141">ProcessRunner</span></span>
    - <span data-ttu-id="cd544-142">UpdateRoleUtilization</span><span class="sxs-lookup"><span data-stu-id="cd544-142">UpdateRoleUtilization</span></span>

5. <span data-ttu-id="cd544-143">Seleccione **ProcessRunCaller** y después seleccione **Agregar**.</span><span class="sxs-lookup"><span data-stu-id="cd544-143">Select **ProcessRunCaller**, and then select **Add**.</span></span>
6. <span data-ttu-id="cd544-144">En el siguiente cuadro de diálogo, seleccione **Aceptar**.</span><span class="sxs-lookup"><span data-stu-id="cd544-144">In the next dialog box, select **OK**.</span></span> <span data-ttu-id="cd544-145">El flujo de trabajo **Reposo** va seguido de un flujo de trabajo **Proceso**.</span><span class="sxs-lookup"><span data-stu-id="cd544-145">A **Sleep** workflow is followed by a **Process** workflow.</span></span>

    <span data-ttu-id="cd544-146">También puede seleccionar **ProcessRunner** en el paso 5.</span><span class="sxs-lookup"><span data-stu-id="cd544-146">You can also select **ProcessRunner** in step 5.</span></span> <span data-ttu-id="cd544-147">A continuación, cuando se selecciona **Aceptar**, el flujo de trabajo **Proceso** va seguido del flujo de trabajo **Reposo**.</span><span class="sxs-lookup"><span data-stu-id="cd544-147">Then, when you select **OK**, a **Process** workflow is followed by a **Sleep** workflow.</span></span>

<span data-ttu-id="cd544-148">Los flujos de trabajo **ProcessRunCaller** y **ProcessRunner** crean facturas.</span><span class="sxs-lookup"><span data-stu-id="cd544-148">The **ProcessRunCaller** and **ProcessRunner** workflows create invoices.</span></span> <span data-ttu-id="cd544-149">**ProcessRunCaller** llama a **ProcessRunner**.</span><span class="sxs-lookup"><span data-stu-id="cd544-149">**ProcessRunCaller** calls **ProcessRunner**.</span></span> <span data-ttu-id="cd544-150">**ProcessRunner** es el flujo de trabajo que crea realmente las facturas.</span><span class="sxs-lookup"><span data-stu-id="cd544-150">**ProcessRunner** is the workflow that actually creates the invoices.</span></span> <span data-ttu-id="cd544-151">Pasa por todas las líneas de contrato para las que se deben crear facturas y crea las facturas para dichas líneas.</span><span class="sxs-lookup"><span data-stu-id="cd544-151">It goes through all the contract lines that invoices must be created for, and it creates invoices for those lines.</span></span> <span data-ttu-id="cd544-152">Para determinar las líneas de contrato para las que se deben crear facturas, el trabajo busca fechas de ejecución de facturas para las líneas de contrato.</span><span class="sxs-lookup"><span data-stu-id="cd544-152">To determine the contract lines that invoices must be created for, the job looks at invoice run dates for the contract lines.</span></span> <span data-ttu-id="cd544-153">Si hay líneas de contrato que pertenecen a un contrato que tiene la misma fecha de ejecución de factura, las transacciones se combinarán en una factura con dos líneas de factura.</span><span class="sxs-lookup"><span data-stu-id="cd544-153">If contract lines that belong to one contract have the same invoice run date, the transactions are combined into one invoice that has two invoice lines.</span></span> <span data-ttu-id="cd544-154">Si no hay transacciones para crear facturas, el trabajo omite la creación de factura.</span><span class="sxs-lookup"><span data-stu-id="cd544-154">If there are no transactions to create invoices for, the job skips invoice creation.</span></span>

<span data-ttu-id="cd544-155">Cuando finaliza la ejecución de **ProcessRunner**, se llama al flujo de trabajo **ProcessRunCaller**, que proporciona la hora de finalización y después se cierra.</span><span class="sxs-lookup"><span data-stu-id="cd544-155">After **ProcessRunner** has finished running, it calls **ProcessRunCaller**, provides the end time, and is closed.</span></span> <span data-ttu-id="cd544-156">A continuación, **ProcessRunCaller** pone en marcha un temporizador que se ejecuta durante 24 horas desde la hora de finalización especificada.</span><span class="sxs-lookup"><span data-stu-id="cd544-156">**ProcessRunCaller** then starts a timer that runs for 24 hours from the specified end time.</span></span> <span data-ttu-id="cd544-157">Cuando se agota el tiempo del temporizador, el flujo de trabajo **ProcessRunCaller** se cierra.</span><span class="sxs-lookup"><span data-stu-id="cd544-157">At the end of the timer, **ProcessRunCaller** is closed.</span></span>

<span data-ttu-id="cd544-158">El trabajo del proceso por lotes para la creación de facturas es un trabajo recurrente.</span><span class="sxs-lookup"><span data-stu-id="cd544-158">The batch process job for creating invoices is a recurrent job.</span></span> <span data-ttu-id="cd544-159">Si este proceso por lotes se ejecuta muchas veces, se crean varias instancias del trabajo y se generan errores.</span><span class="sxs-lookup"><span data-stu-id="cd544-159">If this batch process is run many times, multiple instances of the job are created and cause errors.</span></span> <span data-ttu-id="cd544-160">Por lo tanto, debe iniciar el proceso por lotes solo una vez y debe reiniciarlo solo si se detiene su ejecución.</span><span class="sxs-lookup"><span data-stu-id="cd544-160">Therefore, you should start the batch process only one time, and you should restart it only if it stops running.</span></span>
 
### <a name="edit-a-draft-psa-invoice"></a><span data-ttu-id="cd544-161">Editar un borrador de factura de PSA</span><span class="sxs-lookup"><span data-stu-id="cd544-161">Edit a draft PSA invoice</span></span>

<span data-ttu-id="cd544-162">Cuando se crea un borrador de factura de proyecto, todas las transacciones de venta sin facturar que se crearon cuando se aprobaron las entradas de tiempo y gastos se incluyen en la factura.</span><span class="sxs-lookup"><span data-stu-id="cd544-162">When you create a draft project invoice, all unbilled sales transactions that were created when the time and expense entries were approved are pulled onto the invoice.</span></span> <span data-ttu-id="cd544-163">Puede realizar los siguientes ajustes mientras facturación aún está en fase de borrador:</span><span class="sxs-lookup"><span data-stu-id="cd544-163">You can make the following adjustments while the invoice is still in a draft stage:</span></span>

- <span data-ttu-id="cd544-164">Eliminar o editar los detalles de la línea de factura.</span><span class="sxs-lookup"><span data-stu-id="cd544-164">Delete or edit invoice line details.</span></span>
- <span data-ttu-id="cd544-165">Editar y ajustar la cantidad y el tipo de facturación.</span><span class="sxs-lookup"><span data-stu-id="cd544-165">Edit and adjust the quantity and billing type.</span></span>
- <span data-ttu-id="cd544-166">Agregar directamente a la factura el tiempo, los gastos y las tarifas como transacciones.</span><span class="sxs-lookup"><span data-stu-id="cd544-166">Directly add time, expense, and fees as transactions on the invoice.</span></span> <span data-ttu-id="cd544-167">Puede usar esta característica si la línea de la factura se asigna a una línea de contrato que permita estas clases de transacciones.</span><span class="sxs-lookup"><span data-stu-id="cd544-167">You can use this feature if the invoice line is mapped to a contract line that allows for these transaction classes.</span></span>

<span data-ttu-id="cd544-168">Seleccione **Confirmar** para confirmar una factura.</span><span class="sxs-lookup"><span data-stu-id="cd544-168">Select **Confirm** to confirm an invoice.</span></span> <span data-ttu-id="cd544-169">La acción Confirmar es una acción unidireccional.</span><span class="sxs-lookup"><span data-stu-id="cd544-169">The Confirm action is a one-way action.</span></span> <span data-ttu-id="cd544-170">Cuando se selecciona **Confirmar**, el sistema convierte la factura en factura de solo lectura y crea datos reales de ventas facturadas de todos los detalles de cada línea de factura.</span><span class="sxs-lookup"><span data-stu-id="cd544-170">When you select **Confirm**, the system makes the invoice read-only and creates billed sales actuals from each invoice line detail for each invoice line.</span></span> <span data-ttu-id="cd544-171">Si el detalle de la línea de factura hace referencia a un dato real de ventas sin facturar, el sistema también revierte el dato real de ventas sin facturar.</span><span class="sxs-lookup"><span data-stu-id="cd544-171">If the invoice line detail references an unbilled sales actual, the system also reverses the unbilled sales actual.</span></span> <span data-ttu-id="cd544-172">(Los detalles de línea de factura que se crearon a partir de una entrada de tiempo o gasto harán referencia a un dato real de ventas sin facturar.) Los sistemas de integración de contabilidad general pueden usar esta reversión para revertir trabajo de un proyecto en proceso (WIP) con propósitos de contabilidad.</span><span class="sxs-lookup"><span data-stu-id="cd544-172">(Any invoice line detail that was created from a time or expense entry will reference an unbilled sales actual.) General ledger integration systems can use this reversal to reverse project work in progress (WIP) for accounting purposes.</span></span>

### <a name="correct-a-confirmed-psa-invoice"></a><span data-ttu-id="cd544-173">Corregir una factura de PSA confirmada</span><span class="sxs-lookup"><span data-stu-id="cd544-173">Correct a confirmed PSA invoice</span></span>

<span data-ttu-id="cd544-174">Las facturas de PSA confirmadas se pueden editar (corregir).</span><span class="sxs-lookup"><span data-stu-id="cd544-174">Confirmed PSA invoices can be edited (corrected).</span></span> <span data-ttu-id="cd544-175">Cuando se corrige una factura confirmada, se crea un nuevo borrador de factura correctiva.</span><span class="sxs-lookup"><span data-stu-id="cd544-175">When you correct a confirmed invoice, a new draft corrective invoice is created.</span></span> <span data-ttu-id="cd544-176">Puesto que se da por sentado que desea revertir todas las transacciones y las cantidades de factura original, esta factura correctiva incluye todas las transacciones de la factura original y todas sus cantidades son iguales a 0 (cero).</span><span class="sxs-lookup"><span data-stu-id="cd544-176">Because the assumption is that you want to reverse all the transactions and quantities from the original invoice, this corrective invoice includes all the transactions from the original invoice, and all the quantities on it are 0 (zero).</span></span>

<span data-ttu-id="cd544-177">Si alguna transacción no requiere corrección, puede quitarla del borrador de la factura correctiva.</span><span class="sxs-lookup"><span data-stu-id="cd544-177">If any transactions don't require correction, you can remove them from the draft corrective invoice.</span></span> <span data-ttu-id="cd544-178">Si desea revertir o devolver solo una cantidad parcial, puede editar el campo **Cantidad** en el detalle de la línea.</span><span class="sxs-lookup"><span data-stu-id="cd544-178">If you want to reverse or return only a partial quantity, you can edit the **Quantity** field on the line detail.</span></span> <span data-ttu-id="cd544-179">Si abre el detalle de la línea de factura, podrá ver la cantidad de la factura original.</span><span class="sxs-lookup"><span data-stu-id="cd544-179">If you open the invoice line detail, you can see the original invoice quantity.</span></span> <span data-ttu-id="cd544-180">A continuación, podrá editar la cantidad de la factura actual para que sea superior o inferior a la cantidad de la factura original.</span><span class="sxs-lookup"><span data-stu-id="cd544-180">You can then edit the current invoice quantity so that it's less than or more than the original invoice quantity.</span></span>

<span data-ttu-id="cd544-181">Cuando se confirma una factura correctiva, el dato real de ventas facturadas originales se revierte y se crea un nuevo dato real de ventas facturadas.</span><span class="sxs-lookup"><span data-stu-id="cd544-181">When you confirm a corrective invoice, the original billed sales actual is reversed, and a new billed sales actual is created.</span></span> <span data-ttu-id="cd544-182">Si la cantidad se redujo, la diferencia también generará un nuevo dato real de ventas sin facturar.</span><span class="sxs-lookup"><span data-stu-id="cd544-182">If the quantity was reduced, the difference will cause a new unbilled sales actual to be created too.</span></span> <span data-ttu-id="cd544-183">Por ejemplo, si las ventas facturadas originales ascendían a ocho horas y el detalle de línea de factura correctiva tenía una cantidad reducida de seis horas, PSA revertirá la línea de ventas facturadas originales y creará dos nuevos datos reales:</span><span class="sxs-lookup"><span data-stu-id="cd544-183">For example, if the original billed sales was for eight hours, and the corrective invoice line detail has a reduced quantity of six hours, PSA reverses the original billed sales line and creates two new actuals:</span></span>

- <span data-ttu-id="cd544-184">Un dato real de ventas facturadas por seis horas.</span><span class="sxs-lookup"><span data-stu-id="cd544-184">A billed sales actual for six hours.</span></span>
- <span data-ttu-id="cd544-185">Un dato real de ventas sin facturar por las dos horas restantes.</span><span class="sxs-lookup"><span data-stu-id="cd544-185">An unbilled sales actual for the remaining two hours.</span></span> <span data-ttu-id="cd544-186">Esta transacción se puede facturar más adelante o se puede marcar como no imputable, en función de las negociaciones con el cliente.</span><span class="sxs-lookup"><span data-stu-id="cd544-186">This transaction can either be billed later or marked as non-chargeable, depending on the negotiations with the customer.</span></span>
