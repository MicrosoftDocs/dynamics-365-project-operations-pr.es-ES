---
title: Integración de gestión de gastos
description: Este tema proporciona información sobre la integración de informes de gastos en Project Operations utilizando doble escritura.
author: sigitac
ms.date: 04/28/2021
ms.topic: article
ms.prod: ''
ms.service: project-operations
ms.reviewer: kfend
ms.author: sigitac
ms.openlocfilehash: 8c347f14f3a479eb4aec951cfe4094c5581bce32
ms.sourcegitcommit: 02f00960198cc78a5e96955a9e4390c2c6393bbf
ms.translationtype: HT
ms.contentlocale: es-ES
ms.lasthandoff: 04/28/2021
ms.locfileid: "5955841"
---
# <a name="expense-management-integration"></a><span data-ttu-id="f1f2c-103">Integración de gestión de gastos</span><span class="sxs-lookup"><span data-stu-id="f1f2c-103">Expense management integration</span></span>

<span data-ttu-id="f1f2c-104">_**Se aplica a:** Project Operations para escenarios basados en recursos/no en existencias_</span><span class="sxs-lookup"><span data-stu-id="f1f2c-104">_**Applies To:** Project Operations for resource/non-stocked based scenarios_</span></span>

<span data-ttu-id="f1f2c-105">Este tema proporciona información sobre la integración de informes de gastos en Project Operations [implementación de gasto completo](../expense/expense-overview.md) utilizando doble escritura.</span><span class="sxs-lookup"><span data-stu-id="f1f2c-105">This topic provides information about expense reports integration in Project Operations [full expense deployment](../expense/expense-overview.md) using dual-write.</span></span>

## <a name="expense-categories"></a><span data-ttu-id="f1f2c-106">Categorías de gasto</span><span class="sxs-lookup"><span data-stu-id="f1f2c-106">Expense categories</span></span>

<span data-ttu-id="f1f2c-107">En una implementación de gasto completo, las categorías de gastos se crean y mantienen en aplicaciones de Finance and Operations.</span><span class="sxs-lookup"><span data-stu-id="f1f2c-107">In a full expense deployment, expense categories are created and maintained in Finance and Operations apps.</span></span> <span data-ttu-id="f1f2c-108">Para crear una nueva categoría de gasto, siga estos pasos:</span><span class="sxs-lookup"><span data-stu-id="f1f2c-108">To create a new expense category, complete the following steps:</span></span>

1. <span data-ttu-id="f1f2c-109">En Microsoft Dataverse, cree una categoría **Transacción**.</span><span class="sxs-lookup"><span data-stu-id="f1f2c-109">In Microsoft Dataverse, create a **Transaction** category.</span></span> <span data-ttu-id="f1f2c-110">La integración de doble escritura sincronizará esta categoría de transacción para aplicaciones de Finance and Operations.</span><span class="sxs-lookup"><span data-stu-id="f1f2c-110">Dual-write integration will synchronize this transaction category to Finance and Operations apps.</span></span> <span data-ttu-id="f1f2c-111">Para más información, vea [Configurar categorías de proyectos](/dynamics365/project-operations/project-accounting/configure-project-categories) y [Configuración de Project Operations e integración de datos de configuración](resource-dual-write-setup-integration.md).</span><span class="sxs-lookup"><span data-stu-id="f1f2c-111">For more information, see [Configure project categories](/dynamics365/project-operations/project-accounting/configure-project-categories) and [Project Operations setup and configuration data integration](resource-dual-write-setup-integration.md).</span></span> <span data-ttu-id="f1f2c-112">Como resultado de esta integración, el sistema crea cuatro registros de categorías compartidas en aplicaciones de Finance and Operations.</span><span class="sxs-lookup"><span data-stu-id="f1f2c-112">As a result of this integration, the system creates four shared category records in Finance and Operations apps.</span></span>
2. <span data-ttu-id="f1f2c-113">En Finance, vaya a **Administración de gastos** > **Configuración** > **Categorías compartidas** y seleccione una categoría compartida con una clase de transacción **Gasto**.</span><span class="sxs-lookup"><span data-stu-id="f1f2c-113">In Finance, go to **Expense management** > **Setup** > **Shared categories** and select a shared category with an **Expense** transaction class.</span></span> <span data-ttu-id="f1f2c-114">Establezca el parámetro **Se puede utilizar en Gastos** como **True** y defina el tipo de gasto a utilizar.</span><span class="sxs-lookup"><span data-stu-id="f1f2c-114">Set the **Can be used in Expense** parameter to **True** and define the expense type to use.</span></span>
3. <span data-ttu-id="f1f2c-115">Con este registro de categoría compartida, cree una nueva categoría de gastos yendo a **Administración de gastos** > **Configuración** > **Categorías de gasto** y seleccionando **Nuevo**.</span><span class="sxs-lookup"><span data-stu-id="f1f2c-115">Using this shared category record, create a new expense category by going to **Expense management** > **Setup** > **Expense categories** and selecting **New**.</span></span> <span data-ttu-id="f1f2c-116">Cuando se guarda el registro, la doble escritura usa la asignación de tabla, **Entidad de exportación de categorías de gastos de proyecto de integración de Project Operations (msdyn\_expensecategories)** para sincronizar este registro con Dataverse.</span><span class="sxs-lookup"><span data-stu-id="f1f2c-116">When the record is saved, dual-write uses the table map, **Project Operations integration project expense categories export entity (msdyn\_expensecategories)** to synchronize this record to Dataverse.</span></span>

  ![Integración de categorías de gastos](./media/DW6ExpenseCategories.png)

<span data-ttu-id="f1f2c-118">Las categorías de gastos en las aplicaciones de Finance and Operations son específicas de la empresa o entidad legal.</span><span class="sxs-lookup"><span data-stu-id="f1f2c-118">Expense categories in Finance and Operations apps are company- or legal entity-specific.</span></span> <span data-ttu-id="f1f2c-119">Hay registros específicos de entidad legal correspondientes separados en Dataverse.</span><span class="sxs-lookup"><span data-stu-id="f1f2c-119">There are separate, corresponding legal entity-specific records in Dataverse.</span></span> <span data-ttu-id="f1f2c-120">Cuando un jefe de proyecto estima gastos, no puede seleccionar categorías de gastos que se crearon para un proyecto que es propiedad de una empresa diferente a la empresa propietaria del proyecto en el que está trabajando.</span><span class="sxs-lookup"><span data-stu-id="f1f2c-120">When a project manager estimates expenses, they can’t select expense categories that were created for a project that is owned by a different company than the company that owns the project they are working on.</span></span> 

## <a name="expense-reports"></a><span data-ttu-id="f1f2c-121">Informes de gastos</span><span class="sxs-lookup"><span data-stu-id="f1f2c-121">Expense reports</span></span>

<span data-ttu-id="f1f2c-122">Los informes de gastos se crean y aprueban en aplicaciones de Finance and Operations.</span><span class="sxs-lookup"><span data-stu-id="f1f2c-122">Expense reports are created and approved in Finance and Operations apps.</span></span> <span data-ttu-id="f1f2c-123">Para más información, vea [Crear y procesar informes de gastos en Dynamics 365 Project Operations](/learn/modules/create-process-expense-reports/).</span><span class="sxs-lookup"><span data-stu-id="f1f2c-123">For more information, see [Create and process expense reports in Dynamics 365 Project Operations](/learn/modules/create-process-expense-reports/).</span></span> <span data-ttu-id="f1f2c-124">Una vez que el jefe de proyecto aprueba el informe de gastos, se registra en contabilidad general.</span><span class="sxs-lookup"><span data-stu-id="f1f2c-124">After the expense report is approved by the Project manager, it's posted to the general ledger.</span></span> <span data-ttu-id="f1f2c-125">En Project Operations, las líneas de informes de gastos relacionadas con el proyecto se registran mediante reglas de contabilización especiales:</span><span class="sxs-lookup"><span data-stu-id="f1f2c-125">In Project Operations, project-related expense report lines are posted using special posting rules:</span></span>

  - <span data-ttu-id="f1f2c-126">El coste relacionado con el proyecto (incluido el impuesto no recuperable) no se registra inmediatamente en la cuenta de coste del proyecto en contabilidad general, sino que se registra en la cuenta de integración de gastos.</span><span class="sxs-lookup"><span data-stu-id="f1f2c-126">Project-related cost (including non-recoverable tax) is not immediately posted to project cost account in general ledger, but instead is posted to expense integration account.</span></span> <span data-ttu-id="f1f2c-127">Esta cuenta se configura en **Administración y contabilidad de proyectos** > **Configuración** > **Parámetros de administración y contabilidad de proyectos**, pestaña **Project Operations en Dynamics 365 Customer engagement**.</span><span class="sxs-lookup"><span data-stu-id="f1f2c-127">This account is configured in **Project management and accounting** > **Setup** > **Project management and accounting parameters**, **Project Operations on Dynamics 365 Customer engagement** tab.</span></span>
  - <span data-ttu-id="f1f2c-128">La doble escritura se sincroniza con Dataverse utilizando la asignación de tabla **Entidad de exportación de gastos de proyecto de integración de Project Operations (msdyn\_expenses)** mapa de la mesa.</span><span class="sxs-lookup"><span data-stu-id="f1f2c-128">Dual-write synchronizes to Dataverse using **Project Operations integration project expenses export entity (msdyn\_expenses)** table map.</span></span>
  - <span data-ttu-id="f1f2c-129">La subcontabilidad de impuestos, la subcontabilidad de proveedores y otras contabilizaciones financieras se registran según corresponda en el momento de registrar el informe de gastos.</span><span class="sxs-lookup"><span data-stu-id="f1f2c-129">Tax subledger, vendor subledger, and other financial postings are recorded as applicable at the time of expense report posting.</span></span>

  ![Integración de informes de gastos](./media/DW6ExpenseReports.png)

<span data-ttu-id="f1f2c-131">Cuando se escribe un registro en la entidad **Gastos** en Dataverse, el sistema desencadena el proceso de aprobación automatizado del registro.</span><span class="sxs-lookup"><span data-stu-id="f1f2c-131">When a record is written to the **Expense** entity in Dataverse, the system triggers the automated approval process of the record.</span></span> <span data-ttu-id="f1f2c-132">Si es necesario, el estado del proceso de aprobación automatizado se puede revisar en Dataverse yendo a **Configuración avanzada** > **Sistema** > **Trabajos del sistema**.</span><span class="sxs-lookup"><span data-stu-id="f1f2c-132">If needed, the automated approval process status can be reviewed in Dataverse by going to **Advanced settings** > **System** > **System jobs**.</span></span> <span data-ttu-id="f1f2c-133">Una vez completada la aprobación, se crean registros de clases de transacciones de gastos en la entidad **Datos reales**.</span><span class="sxs-lookup"><span data-stu-id="f1f2c-133">After approval is complete, expense transaction class records are created in the **Actuals** entity.</span></span>

<span data-ttu-id="f1f2c-134">Los datos reales relacionados con gastos se procesan utilizando la asignación de tabla de doble escritura, **Datos reales de integración de Project Operations (msdyn\_actuals)**.</span><span class="sxs-lookup"><span data-stu-id="f1f2c-134">Expense related actuals are then processed using the dual-write table map **Project Operations integration actuals (msdyn\_actuals)**.</span></span> <span data-ttu-id="f1f2c-135">Para obtener más información, consulte [Estimaciones y datos reales del proyecto](resource-dual-write-estimates-actuals.md).</span><span class="sxs-lookup"><span data-stu-id="f1f2c-135">For more information, see [Project estimates and actuals](resource-dual-write-estimates-actuals.md).</span></span>

<span data-ttu-id="f1f2c-136">El proceso periódico **Importar desde tabla de almacenamiento provisional** crea líneas del diario relacionadas con informes de gastos el diario de integración de Project Operations.</span><span class="sxs-lookup"><span data-stu-id="f1f2c-136">The periodic process, **Import from staging** creates Expense report-related journal lines in the Project Operations Integration journal.</span></span> <span data-ttu-id="f1f2c-137">La cuenta de contrapartida tiene como valor predeterminado la cuenta de integración de gastos.</span><span class="sxs-lookup"><span data-stu-id="f1f2c-137">The offset account defaults to the expense integration account.</span></span> <span data-ttu-id="f1f2c-138">El diario de integración de registros borra el saldo de la cuenta para la transacción de gastos y mueve el importe de gastos a la cuenta de coste del proyecto.</span><span class="sxs-lookup"><span data-stu-id="f1f2c-138">The Posting integration journal clears the account balance for the expense transaction and moves the expense amount to the project cost account.</span></span> <span data-ttu-id="f1f2c-139">El sistema también crea transacciones de subcontabilidad del proyecto para fines de facturación descendente y reconocimiento de ingresos.</span><span class="sxs-lookup"><span data-stu-id="f1f2c-139">The system also creates project subledger transactions for downstream invoicing and revenue recognition purposes.</span></span>
